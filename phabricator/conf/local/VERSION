based on git revision f11c4ffcbbc210f3ff4b2d0bc9fb265b06030f41.
